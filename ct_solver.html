<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module ct_solver</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title">ct_solver</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:h%3A%5Cusers%5Clukas%5Cpycharmprojects%5Copenai-assistant-rg-analyzer%5Cct_solver.py">h:\users\lukas\pycharmprojects\openai-assistant-rg-analyzer\ct_solver.py</a></td></tr></table>
    <p><span class="code">This&nbsp;module&nbsp;is&nbsp;used&nbsp;to&nbsp;generate&nbsp;the&nbsp;KG&nbsp;from&nbsp;provided&nbsp;data.<br>
It&nbsp;also&nbsp;applies&nbsp;logic-based&nbsp;rules&nbsp;to&nbsp;identify&nbsp;the&nbsp;movable&nbsp;supply.<br>
It&nbsp;stores&nbsp;the&nbsp;data&nbsp;and&nbsp;a&nbsp;visualization.</span></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="json.html">json</a><br>
<a href="os.html">os</a><br>
</td><td class="multicolumn"><a href="pandas.html">pandas</a><br>
<a href="re.html">re</a><br>
</td><td class="multicolumn"><a href="sys.html">sys</a><br>
</td><td class="multicolumn"></td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-apply_logic_based_rules"><strong>apply_logic_based_rules</strong></a>(graph, df)</dt><dd><span class="code">Application&nbsp;of&nbsp;the&nbsp;logic&nbsp;based&nbsp;rules.<br>
&nbsp;<br>
First,&nbsp;run&nbsp;queries&nbsp;to&nbsp;identify&nbsp;and&nbsp;extract&nbsp;required&nbsp;data.<br>
Second,&nbsp;check&nbsp;whether&nbsp;there&nbsp;is&nbsp;a&nbsp;valid&nbsp;chain&nbsp;transaction.<br>
Third,&nbsp;identify&nbsp;the&nbsp;movable&nbsp;supply.<br>
&nbsp;<br>
:param&nbsp;graph:&nbsp;Knowledge&nbsp;graph&nbsp;from&nbsp;the&nbsp;KG-database<br>
:param&nbsp;df:&nbsp;Dataframe&nbsp;to&nbsp;store&nbsp;the&nbsp;output<br>
:return:&nbsp;none</span></dd></dl>
 <dl><dt><a name="-build_graph"><strong>build_graph</strong></a>(query)</dt><dd><span class="code">Build&nbsp;the&nbsp;graph&nbsp;in&nbsp;Neo4j<br>
:param&nbsp;query:&nbsp;Statements&nbsp;to&nbsp;build&nbsp;the&nbsp;graph<br>
:return:&nbsp;Graph&nbsp;data</span></dd></dl>
 <dl><dt><a name="-clean_statement"><strong>clean_statement</strong></a>(statement)</dt><dd><span class="code">Clean&nbsp;statement&nbsp;to&nbsp;remove&nbsp;inconsistencies<br>
:param&nbsp;statement:&nbsp;Statement&nbsp;to&nbsp;clean<br>
:return:&nbsp;Cleaned&nbsp;statement</span></dd></dl>
 <dl><dt><a name="-delete_graph"><strong>delete_graph</strong></a>()</dt><dd><span class="code">Delete&nbsp;the&nbsp;graph&nbsp;from&nbsp;Neo4j<br>
:return:&nbsp;none</span></dd></dl>
 <dl><dt><a name="-replace_name_fields"><strong>replace_name_fields</strong></a>(text)</dt><dd><span class="code">Replace&nbsp;name&nbsp;field&nbsp;to&nbsp;remove&nbsp;inconsistencies<br>
:param&nbsp;text:&nbsp;Text&nbsp;to&nbsp;clean<br>
:return:&nbsp;cleaned&nbsp;text</span></dd></dl>
 <dl><dt><a name="-visualize_graph"><strong>visualize_graph</strong></a>(graph, tv_name, id_internal, example_name)</dt><dd><span class="code">Custom&nbsp;visualization&nbsp;of&nbsp;the&nbsp;graph<br>
:param&nbsp;graph:&nbsp;Knowledge&nbsp;graph<br>
:param&nbsp;tv_name:&nbsp;Name&nbsp;of&nbsp;transport&nbsp;responsible&nbsp;enterprise<br>
:param&nbsp;id_internal:&nbsp;Internal&nbsp;ID&nbsp;of&nbsp;the&nbsp;case<br>
:param&nbsp;example_name:&nbsp;Name&nbsp;of&nbsp;the&nbsp;case<br>
:return:&nbsp;none</span></dd></dl>
</td></tr></table><p>
<table class="section">
<tr class="decor data-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Data</strong></td></tr>
    
<tr><td class="decor data-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><strong>LANGSMITH_API_KEY</strong> = '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'<br>
<strong>cypher_statement</strong> = '// Unternehmen-Knoten<span class="repr">\n</span>CREATE (Kunde:Unternehmen ... er verantwortlich<span class="repr">\n</span>CREATE (Lieferant)-[:HAT]-&gt;(T)'<br>
<strong>data</strong> = {'Argumentation': '1. Identifikation der Parteien: <span class="repr">\n</span>- Kunde (IT, ke... Lieferanten, da dieser die Lieferung durchführt.', 'Cypher Anweisungen': '// Unternehmen-Knoten<span class="repr">\n</span>CREATE (Kunde:Unternehmen ...er verantwortlich<span class="repr">\n</span>CREATE (Lieferant)-[:HAT]-&gt;(T);', 'Inhaltliche Zusammenfassung': 'Der Kunde in Italien bestellt Waren bei PIZZA &amp; ...ie Transportverantwortung liegt beim Lieferanten.'}<br>
<strong>data_set</strong> = 'REALCASES'<br>
<strong>df_database</strong> =      internal_id                                ...        Ö2-&gt;Ö3       1309

[189 rows x 9 columns]<br>
<strong>df_langsmith</strong> =                                      id         ...ZA &amp; PASTA  check manually

[1 rows x 28 columns]<br>
<strong>df_merged</strong> =                                      id         ...zza Pasta  REALCASES    10

[1 rows x 14 columns]<br>
<strong>example_name</strong> = 'REALCASES_10'<br>
<strong>filename</strong> = 'pg__voo5__gpt-4.1__5bc806a6.csv'<br>
<strong>full_df</strong> = RangeIndex(start=0, stop=1, step=1)<br>
<strong>graph</strong> = &lt;langchain_neo4j.graphs.neo4j_graph.Neo4jGraph object&gt;<br>
<strong>graph_data</strong> = []<br>
<strong>id_internal</strong> = 158<br>
<strong>idx</strong> = 0<br>
<strong>name</strong> = 10<br>
<strong>query_find_dispatch_country</strong> = '<span class="repr">\n</span>    OPTIONAL MATCH (n:Unternehmen)-[:WARENBEWEGUNG]-&gt;(m:Unternehmen) <span class="repr">\n</span>    RETURN n.Sitz<span class="repr">\n</span>    '<br>
<strong>query_find_transport_of_goods</strong> = "<span class="repr">\n</span>    OPTIONAL MATCH (n:Unternehmen)-[:WARENBEWEG...n) <span class="repr">\n</span>    RETURN n, 'WARENBEWEGUNG' as Info, m<span class="repr">\n</span>    "<br>
<strong>query_first_enterprise</strong> = '<span class="repr">\n</span>OPTIONAL MATCH ()-[:BESTELLUNG]-&gt;(n:Unternehmen...ALESCE(n, "Inconsistent, no solution.") AS result'<br>
<strong>query_last_enterprise</strong> = '<span class="repr">\n</span>OPTIONAL MATCH (n:Unternehmen)-[:BESTELLUNG]-&gt;(...LESCE(n, "Inconsistent, no solution.") AS result<span class="repr">\n</span>'<br>
<strong>query_no_of_enterprises</strong> = 'MATCH (n:Unternehmen) RETURN count(n) AS no_of_enterprises'<br>
<strong>query_no_of_orders</strong> = 'MATCH (:Unternehmen)-[r:BESTELLUNG]-&gt;(:Unternehmen) RETURN count(r) AS no_of_orders'<br>
<strong>query_no_of_products</strong> = "<span class="repr">\n</span>    MATCH ()-[r]-&gt;()<span class="repr">\n</span>    WHERE type(r) IN ['BES...ETURN count(DISTINCT r.Produkt) AS no_of_products"<br>
<strong>query_no_of_tr</strong> = 'MATCH (:Unternehmen)-[r:HAT]-(:Transportverantwortung) RETURN count(r) AS no_of_tr'<br>
<strong>query_no_of_transports_of_goods</strong> = 'MATCH (:Unternehmen)-[r:WARENBEWEGUNG]-&gt;(:Unternehmen) RETURN count(r) AS no_of_transports_of_goods'<br>
<strong>query_transport_responsibility</strong> = '<span class="repr">\n</span>    MATCH (n:Unternehmen)-[:HAT]-&gt;(:Transportverantwortung)<span class="repr">\n</span>    RETURN n'<br>
<strong>reference_filename</strong> = 'Beispiele_RG_test_set.xlsx'<br>
<strong>timestamp</strong> = '20250716_2003'<br>
<strong>tr_name</strong> = 'Lieferant'</td></tr></table>
</body></html>